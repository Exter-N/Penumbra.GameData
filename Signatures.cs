namespace Penumbra.GameData;

/// <summary> Signatures in use for Penumbra. </summary>
public static class Sigs
{
    // ResourceLoader.Debug
    public const string ResourceManager = "48 8B 0D ?? ?? ?? ?? 0F 5B F6"; // Works

    // ResourceLoader.Replacement
    public const string GetResourceSync  = "E8 ?? ?? 00 00 48 8D 8F ?? ?? 00 00 48 89 87 ?? ?? 00 00"; // E8 ?? ?? ?? ?? 48 8B D8 8B C7 
    public const string GetResourceAsync = "E8 ?? ?? ?? 00 48 8B D8 EB ?? F0 FF 83 ?? ?? 00 00"; // Works
    public const string ReadFile         = "E8 ?? ?? ?? ?? 84 C0 0F 84 ?? 00 00 00 4C 8B C3 BA 05"; // 48 89 5C 24 ?? 48 89 6C 24 ?? 48 89 74 24 ?? 57 41 54 41 55 41 56 41 57 48 81 EC ?? ?? ?? ?? 48 8B 05 ?? ?? ?? ?? 48 33 C4 48 89 84 24 ?? ?? ?? ?? 48 63 42 
    public const string ReadSqPack       = "E8 ?? ?? ?? ?? EB 05 E8 ?? ?? ?? ?? 84 C0 0F 84 ?? 00 00 00 4C 8B C3"; // 40 56 41 56 48 83 EC ?? 0F BE 02 

    // ResourceLoader.TexMdl
    public const string CheckFileState    = "E8 ?? ?? ?? ?? 48 85 c0 74 ?? 45 0f b6 ce 48 89 44 24"; // E8 ?? ?? ?? ?? 48 85 C0 74 ?? 4C 8B C8 
    public const string LoadTexFileLocal  = "48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 30 49 8B F0 44 88 4C 24 20"; // Works
    public const string LoadMdlFileLocal  = "40 55 53 56 57 41 56 41 57 48 8D 6C 24 D1 48 81 EC 98 00 00 00"; // 48 89 5C 24 ?? 55 56 57 41 54 41 55 41 56 41 57 48 8D 6C 24 ?? 48 81 EC ?? ?? ?? ?? 48 8B 05 ?? ?? ?? ?? 48 33 C4 48 89 45 ?? 48 8B 72 
    public const string LoadTexFileExtern = "E8 ?? ?? ?? ?? 0F B6 E8 48 8B CB E8"; // Inlined in TextureResourceHandle.vf32
    public const string LoadMdlFileExtern = "E8 ?? ?? ?? ?? EB 02 B0 F1"; // Works

    // GameEventManager
    public const string ResourceHandleDestructor = "48 89 5C 24 ?? 57 48 83 EC ?? 48 8D 05 ?? ?? ?? ?? 48 8B D9 48 89 01 B8"; // Works

    public const string CharacterDestructor =
        "48 89 5C 24 ?? 48 89 74 24 ?? 57 48 83 EC ?? 48 8D 05 ?? ?? ?? ?? 48 8B D9 48 89 01 48 8D 05 ?? ?? ?? ?? 48 89 81 ?? ?? ?? ?? 48 81 C1"; // Works

    // PathResolver.AnimationState
    public const string LoadTimelineResources      = "E8 ?? ?? ?? ?? 83 7F ?? ?? 75 ?? 0F B6 87"; // E8 ?? ?? ?? ?? 83 7F ?? ?? 75 ?? 0F B6 87 ?? ?? ?? ?? A8 
    public const string CharacterBaseLoadAnimation = "E8 ?? ?? ?? ?? BA ?? ?? ?? ?? 48 8B CF 44 8B C2 E8 ?? ?? ?? ?? 48 8B 05"; // E8 ?? ?? ?? ?? BA ?? ?? ?? ?? 48 8B CB 44 8B C2 E8 ?? ?? ?? ?? 33 C0 
    public const string LoadSomePap                = "48 89 5C 24 ?? 48 89 6C 24 ?? 48 89 74 24 ?? 57 41 56 41 57 48 83 EC ?? 41 8B D9 89 51"; // Works
    public const string LoadSomeAction             = "E8 ?? ?? ?? ?? C6 83 ?? ?? ?? ?? ?? 8B 8E"; // Works
    public const string LoadCharacterVfx           = "E8 ?? ?? ?? ?? 48 8B F8 48 8D 93"; // E8 ?? ?? ?? ?? 48 85 FF 48 8D 97 
    public const string LoadAreaVfx                = "48 8B C4 53 55 56 57 41 56 48 81 EC"; // E8 ?? ?? ?? ?? 0F 28 74 24 ?? 48 89 43
    public const string ScheduleClipUpdate         = "40 53 55 56 57 41 56 48 81 EC ?? ?? ?? ?? 48 8B F9"; // 40 53 56 57 48 81 EC ?? ?? ?? ?? 48 8B F9 E8 
    public const string UnkMountAnimation          = "48 89 5C 24 ?? 48 89 6C 24 ?? 89 54 24"; // 48 89 5C 24 ?? 48 89 6C 24 ?? 48 89 74 24 ?? 57 41 56 41 57 48 83 EC ?? 41 8B E9 45 0F B6 F8 
    public const string UnkParasolAnimation        = "48 89 5C 24 ?? 48 89 74 24 ?? 89 54 24 ?? 57 48 83 EC ?? 48 8B F9"; // 48 89 5C 24 ?? 48 89 74 24 ?? 48 89 7C 24 ?? 41 56 48 83 EC ?? 8B FA 4C 8B F1 
    public const string Dismount                   = "E8 ?? ?? ?? ?? F6 43 ?? ?? 74 ?? 48 8B CB"; // E9 ?? ?? ?? ?? B8 ?? ?? ?? ?? 66 44 3B F8 
    public const string ApricotListenerSoundPlay   = "48 89 6C 24 ?? 41 54 41 56 41 57 48 81 EC"; // Inlined
    public const string FootStepSound              = "44 89 44 24 ?? 89 54 24 ?? 53 55 57"; // 44 89 44 24 ?? 89 54 24 ?? 55 57 

    // PathResolver.DrawObjectState
    public const string EnableDraw = "E8 ?? ?? ?? ?? 48 8B 8B ?? ?? ?? ?? 48 85 C9 74 33 45 33 C0"; // Works

    // PathResolver.Meta
    public const string UpdateModel       = "48 8B ?? 56 48 83 ?? ?? ?? B9"; // Works
    public const string GetEqpIndirect    = "40 ?? 48 83 ?? ?? ?? 81 ?? ?? ?? ?? ?? 48 8B ?? 74 ?? ?? 83 ?? ?? ?? ?? ?? ?? 74 ?? 4C"; // Works
    public const string GetEqpIndirect2   = "40 57 48 83 EC ?? 8B 81 ?? ?? ?? ?? 48 8B F9 C1 E8 ?? A8 ?? 0F 84"; // 40 57 48 83 EC ?? 48 8B F9 8B 89 ?? ?? ?? ?? 8B C1 
    public const string SetupVisor        = "48 8B ?? 53 55 57 48 83 ?? ?? 48 8B"; // E8 ?? ?? ?? ?? 48 8B 8B ?? ?? ?? ?? 0F 57 E4 
    public const string RspSetupCharacter = "48 89 5C 24 ?? 48 89 6C 24 ?? 48 89 74 24 ?? 88 54 24 ?? 57 41 56"; // 88 54 24 ?? 48 89 4C 24 ?? 53 55 56 57 41 54 41 55 41 57 
    public const string ChangeCustomize   = "E8 ?? ?? ?? ?? 41 0F B6 C5 66 41 89 86"; // E8 ?? ?? ?? ?? 66 44 89 A5 

    public const string GetEqdpAccessoryEntry = "E8 ?? ?? ?? ?? 41 BF ?? ?? ?? ?? 83 FB"; // Works
    public const string GetEqdpEquipEntry     = "E8 ?? ?? ?? ?? 85 DB 75 ?? F6 45"; // Works
    public const string GetEqpEntry           = "E8 ?? ?? ?? ?? 0F B6 44 24 ?? C0 E8"; // E8 ?? ?? ?? ?? 44 0F B6 9E
    public const string GetEstEntry           = "44 8B C9 83 EA ?? 74"; // 48 8B 89 ?? ?? ?? ?? EB ?? 48 8B 89 ?? ?? ?? ?? EB ?? 48 8B 89 ?? ?? ?? ?? 48 85 C9 75 ?? B8 ?? ?? ?? ?? C3 0F B7 D0
    public const string GetGmpEntry           = "E8 ?? ?? ?? ?? 48 85 C0 74 ?? 43 8D 0C"; // E8 ?? ?? ?? ?? 48 8B 44 24 ?? 0F 57 C9 
    public const string GetRspBust            = "E8 ?? ?? ?? ?? F2 0F 10 44 24 ?? 8B 44 24"; // E8 ?? ?? ?? ?? 8B 48 ?? F2 0F 10 38 
    public const string GetRspHeight          = "E8 ?? ?? ?? ?? 48 8B 8E ?? ?? ?? ?? 44 8B CF"; // E8 ?? ?? ?? ?? 66 0F 6E CD 48 8D 44 24 
    public const string GetRspTail            = "E8 ?? ?? ?? ?? 0F 28 F0 48 8B 05"; // E8 ?? ?? ?? ?? F3 0F 11 46 ?? 83 FD 

    // PathResolver.PathState
    public const string HumanVTable = "48 8D 05 ?? ?? ?? ?? 48 89 03 48 B8 ?? ?? ?? ?? ?? ?? ?? ?? 89 8B"; // 48 8D 05 ?? ?? ?? ?? 48 89 03 89 8B 

    public const string WeaponVTable =
        "48 8D 05 ?? ?? ?? ?? 48 89 03 B8 ?? ?? ?? ?? 66 89 83 ?? ?? ?? ?? 48 8B C3 48 89 8B ?? ?? ?? ?? 48 89 8B"; // Works

    public const string DemiHumanVTable = "48 8D 05 ?? ?? ?? ?? 48 89 03 48 8B C3 89 8B"; // Works
    public const string MonsterVTable   = "48 8D 05 ?? ?? ?? ?? 48 89 03 33 C0 48 89 83 ?? ?? ?? ?? 48 89 83 ?? ?? ?? ?? C7 83"; // Works

    // PathResolver.Subfiles
    public const string LoadMtrlTex = "4C 8B DC 49 89 5B ?? 49 89 73 ?? 55 57 41 55"; // E8 ?? ?? ?? ?? 84 C0 B9 ?? ?? ?? ?? BA ?? ?? ?? ?? 0F 44 CA 0F B6 C1 48 83 C4 ?? C3 0F B6 C2 

    public const string LoadMtrlShpk =
        "48 89 5C 24 ?? 57 48 81 EC ?? ?? ?? ?? 48 8B 05 ?? ?? ?? ?? 48 33 C4 48 89 84 24 ?? ?? ?? ?? 44 0F B7 89"; // Works

    public const string ApricotResourceLoad = "48 89 74 24 ?? 57 48 83 EC ?? 41 0F B6 F0 48 8B F9"; // 48 89 5C 24 ?? 57 48 83 EC ?? 41 0F B6 F8 48 8B D9 40 80 FF 

    // CharacterUtility
    public const string CharacterUtility       = "48 8B 05 ?? ?? ?? ?? 83 B9"; // Works
    public const string LoadCharacterResources = "E8 ?? ?? ?? ?? 48 8D 8F ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 D2 45 33 C0"; // E8 ?? ?? ?? ?? 49 8D 8F ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 D2 45 33 C0 

    // MetaFileManager
    public const string GetFileSpace = "E8 ?? ?? ?? ?? 41 B9 ?? ?? ?? ?? 4C 8B C0"; // E8 ?? ?? ?? ?? 41 B9 ?? ?? ?? ?? 4C 8B C0 33 D2 

    // ResidentResourceManager
    public const string ResidentResourceManager = "0F 44 FE 48 8B 0D ?? ?? ?? ?? 48 85 C9 74 05"; // Works

    public const string LoadPlayerResources =
        "E8 ?? ?? ?? ?? 48 8B 05 ?? ?? ?? ?? BA ?? ?? ?? ?? 41 B8 ?? ?? ?? ?? 48 8B 48 30 48 8B 01 FF 50 10 48 85 C0 74 0A"; // Works

    public const string UnloadPlayerResources =
        "41 55 48 81 EC ?? ?? ?? ?? 48 8B 05 ?? ?? ?? ?? 48 33 C4 48 89 84 24 ?? ?? ?? ?? 4C 8B E9 48 83 C1 08"; // 40 53 48 83 EC ?? 48 8B D9 48 83 C1 ?? E8 ?? ?? ?? ?? 80 7B 

    // ModelResourceHandleUtility
    public const string GetMaterialFileNameBySlot = "E8 ?? ?? ?? ?? 44 8B CD 48 89 44 24"; // E8 ?? ?? ?? ?? 44 8B CD 48 89 44 24 ?? 41 B8 

    // ModelRenderer
    public const string RenderManager = "48 8B 05 ?? ?? ?? ?? 48 69 D1"; // Works?

    // ShaderReplacementFixer
    public const string ModelRendererOnRenderMaterial = "E8 ?? ?? ?? ?? 80 7D ?? ?? 0F B7 08"; // E8 ?? ?? ?? ?? 44 0F B7 38 

    // Job service
    public const string ChangeJob = "48 89 5C 24 ?? 48 89 6C 24 ?? 48 89 74 24 ?? 57 41 56 41 57 48 83 EC ?? 80 61"; // 48 89 5C 24 ?? 48 89 6C 24 ?? 48 89 74 24 ?? 57 41 56 41 57 48 83 EC ?? 44 0F B6 FA 48 8B E9 

    // Flag Slot for Update service
    public const string FlagSlotForUpdate = "48 89 5C 24 ?? 48 89 74 24 ?? 57 48 83 EC 20 8B DA 49 8B F0 48 8B F9 83 FA 0A"; // 48 89 5C 24 ?? 48 89 74 24 ?? 57 48 83 EC ?? 8B DA 49 8B F0 48 8B F9 

    // Partial/composable materials
    public const string CreateMaterial = "E8 ?? ?? ?? ?? 48 89 87 ?? ?? ?? ?? 48 85 C0 0F 84 ?? ?? ?? ?? 45 8B DC"; // E8 ?? ?? ?? ?? 48 89 87 ?? ?? ?? ?? 48 85 C0 75 ?? 48 8B 8F ?? ?? ?? ?? 48 85 C9 74 ?? 48 8B 01 

    public const string PlaceMinion = "48 89 5C 24 ?? 55 57 41 57 48 8D 6C 24"; // 48 89 5C 24 ?? 55 57 41 57 48 8D 6C 24 ?? 48 81 EC ?? ?? ?? ?? 48 8B F9 

    public const string PrepareColorSet = "40 55 56 41 56 48 83 EC ?? 80 BA"; // E8 ?? ?? ?? ?? 49 89 04 ?? 49 83 C5   (Signature changed)

    public const string CalculateHeight = "E8 ?? ?? ?? FF 48 8B 0D ?? ?? ?? ?? 0F 28 F0"; // Works

    public const string CrestChange = "E8 ?? ?? ?? ?? 48 8B 55 ?? 49 8B CE E8"; // Works
}
